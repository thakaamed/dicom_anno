# Research Preset
# Balanced de-identification for research use
# Retains longitudinal data with date shifting

name: "Research"
description: "Balanced anonymization for research studies. Retains longitudinal temporal relationships through date shifting."
version: "1.0.0"

compliance:
  - "DICOM PS3.15 Basic Profile"
  - "DICOM PS3.15 Retain Longitudinal"
  - "DICOM PS3.15 Retain Patient Characteristics"

# Profile options - retain useful research data
clean_pixel_data: false
clean_visual_features: false
retain_longitudinal: true
retain_patient_characteristics: true
retain_device_identity: true
retain_institution_identity: false
retain_safe_private: false

# Date handling - shift dates to preserve intervals
date_handling: "shift"
date_shift_base: "19750101"

# Age handling - still protect ages >89 per HIPAA
age_threshold: 89

# Remove most private tags but allow safe ones
remove_private_tags: true
safe_private_tags: []

# Tag-specific rules for research use
tag_rules:
  # ===========================================
  # Patient Module - Anonymize identifiers
  # ===========================================
  - tag: "(0010,0010)"
    action: "Z"
    replacement: "ANONYMIZED"
    description: "Patient's Name"

  - tag: "(0010,0020)"
    action: "Z"
    replacement: ""
    description: "Patient ID"

  - tag: "(0010,0030)"
    action: "Z"
    description: "Patient's Birth Date - shifted"

  - tag: "(0010,0032)"
    action: "Z"
    description: "Patient's Birth Time"

  - tag: "(0010,0040)"
    action: "K"
    description: "Patient's Sex - kept for research"

  - tag: "(0010,1000)"
    action: "X"
    description: "Other Patient IDs"

  - tag: "(0010,1001)"
    action: "X"
    description: "Other Patient Names"

  - tag: "(0010,1010)"
    action: "C"
    description: "Patient's Age - cleaned (>89 becomes 90+)"

  - tag: "(0010,1040)"
    action: "X"
    description: "Patient's Address"

  - tag: "(0010,2154)"
    action: "X"
    description: "Patient's Telephone Numbers"

  # ===========================================
  # Study/Series Dates - Shift all dates
  # ===========================================
  - tag: "(0008,0020)"
    action: "C"
    description: "Study Date - shifted"

  - tag: "(0008,0021)"
    action: "C"
    description: "Series Date - shifted"

  - tag: "(0008,0022)"
    action: "C"
    description: "Acquisition Date - shifted"

  - tag: "(0008,0023)"
    action: "C"
    description: "Content Date - shifted"

  - tag: "(0008,0030)"
    action: "C"
    description: "Study Time - shifted"

  - tag: "(0008,0031)"
    action: "C"
    description: "Series Time - shifted"

  - tag: "(0008,0032)"
    action: "C"
    description: "Acquisition Time - shifted"

  - tag: "(0008,0033)"
    action: "C"
    description: "Content Time - shifted"

  - tag: "(0008,0050)"
    action: "Z"
    description: "Accession Number"

  # ===========================================
  # UIDs - Replace with new consistent UIDs
  # ===========================================
  - tag: "(0020,000D)"
    action: "U"
    description: "Study Instance UID"

  - tag: "(0020,000E)"
    action: "U"
    description: "Series Instance UID"

  - tag: "(0008,0018)"
    action: "U"
    description: "SOP Instance UID"

  - tag: "(0008,0016)"
    action: "K"
    description: "SOP Class UID - Keep unchanged"

  - tag: "(0020,0052)"
    action: "U"
    description: "Frame of Reference UID"

  # ===========================================
  # Institution/Provider Information
  # ===========================================
  - tag: "(0008,0080)"
    action: "X"
    description: "Institution Name"

  - tag: "(0008,0081)"
    action: "X"
    description: "Institution Address"

  - tag: "(0008,0090)"
    action: "Z"
    description: "Referring Physician's Name"

  - tag: "(0008,1048)"
    action: "X"
    description: "Physician(s) of Record"

  - tag: "(0008,1050)"
    action: "X"
    description: "Performing Physician's Name"

  - tag: "(0008,1070)"
    action: "X"
    description: "Operators' Name"

  # ===========================================
  # Descriptive Fields - Keep for research
  # ===========================================
  - tag: "(0008,103E)"
    action: "K"
    description: "Series Description - kept for research"

  - tag: "(0008,1030)"
    action: "K"
    description: "Study Description - kept for research"

  - tag: "(0010,4000)"
    action: "X"
    description: "Patient Comments"

  # ===========================================
  # Equipment Information - Keep for research
  # ===========================================
  - tag: "(0008,0070)"
    action: "K"
    description: "Manufacturer - kept for research"

  - tag: "(0008,1090)"
    action: "K"
    description: "Manufacturer's Model Name - kept for research"

  - tag: "(0008,1010)"
    action: "X"
    description: "Station Name"

  - tag: "(0018,1000)"
    action: "X"
    description: "Device Serial Number"

  - tag: "(0018,1002)"
    action: "U"
    description: "Device UID"
